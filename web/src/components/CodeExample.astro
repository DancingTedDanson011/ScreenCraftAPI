---
// CodeExample Component - ScreenCraft Landing Page
import DemoWidget from './DemoWidget';

const curlExample = `curl -X POST "https://api.screencraft.io/v1/screenshot" \\
  -H "Authorization: Bearer YOUR_API_KEY" \\
  -H "Content-Type: application/json" \\
  -d '{
    "url": "https://example.com",
    "format": "png",
    "viewport": { "width": 1920, "height": 1080 }
  }'`;

const nodeExample = `const screenshot = await fetch('https://api.screencraft.io/v1/screenshot', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer YOUR_API_KEY',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    url: 'https://example.com',
    format: 'png',
    viewport: { width: 1920, height: 1080 }
  })
});

const image = await screenshot.blob();`;

const pythonExample = `import requests

response = requests.post(
    'https://api.screencraft.io/v1/screenshot',
    headers={'Authorization': 'Bearer YOUR_API_KEY'},
    json={
        'url': 'https://example.com',
        'format': 'png',
        'viewport': {'width': 1920, 'height': 1080}
    }
)

image = response.content`;
---

<section id="code-example" class="py-20 md:py-32 bg-[#161B22]">
  <div class="container mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Section Header -->
    <div class="text-center mb-12">
      <h2 class="text-3xl sm:text-4xl lg:text-5xl font-bold text-[#F0F6FC] mb-4">
        From zero to screenshot in 3 lines of code
      </h2>
      <p class="text-lg text-[#8B949E] max-w-2xl mx-auto">
        Choose your language and start capturing screenshots instantly
      </p>
    </div>

    <!-- Code Tabs -->
    <div class="max-w-4xl mx-auto">
      <div class="bg-[#0D1117] border border-[#30363D] rounded-xl overflow-hidden">
        <!-- Tab Navigation -->
        <div class="flex gap-1 border-b border-[#30363D] px-4 pt-4">
          <button
            class="code-tab px-4 py-2 text-sm font-medium rounded-t-lg transition-colors bg-[#161B22] text-[#F0F6FC] border-t border-l border-r border-[#30363D]"
            data-tab="curl"
          >
            cURL
          </button>
          <button
            class="code-tab px-4 py-2 text-sm font-medium rounded-t-lg transition-colors text-[#8B949E] hover:text-[#F0F6FC]"
            data-tab="nodejs"
          >
            Node.js
          </button>
          <button
            class="code-tab px-4 py-2 text-sm font-medium rounded-t-lg transition-colors text-[#8B949E] hover:text-[#F0F6FC]"
            data-tab="python"
          >
            Python
          </button>
        </div>

        <!-- Code Content -->
        <div class="relative">
          <!-- cURL Example -->
          <div class="code-content" data-content="curl">
            <pre class="p-6 overflow-x-auto"><code class="font-mono text-sm text-[#F0F6FC]">{curlExample}</code></pre>
          </div>

          <!-- Node.js Example -->
          <div class="code-content hidden" data-content="nodejs">
            <pre class="p-6 overflow-x-auto"><code class="font-mono text-sm text-[#F0F6FC]">{nodeExample}</code></pre>
          </div>

          <!-- Python Example -->
          <div class="code-content hidden" data-content="python">
            <pre class="p-6 overflow-x-auto"><code class="font-mono text-sm text-[#F0F6FC]">{pythonExample}</code></pre>
          </div>

          <!-- Copy Button -->
          <button
            class="copy-btn absolute top-4 right-4 px-3 py-2 text-xs text-[#8B949E] hover:text-[#F0F6FC] bg-[#161B22] border border-[#30363D] rounded-lg flex items-center gap-2 transition-colors"
          >
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
            </svg>
            Copy
          </button>
        </div>
      </div>

      <!-- Live Demo Widget -->
      <div class="mt-8">
        <DemoWidget client:load />
      </div>
    </div>
  </div>
</section>

<script>
  // Tab switching functionality
  const tabs = document.querySelectorAll('.code-tab');
  const contents = document.querySelectorAll('.code-content');

  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      const targetTab = (tab as HTMLElement).dataset.tab;

      // Update tab styles
      tabs.forEach(t => {
        if ((t as HTMLElement).dataset.tab === targetTab) {
          t.classList.add('bg-[#161B22]', 'text-[#F0F6FC]', 'border-t', 'border-l', 'border-r', 'border-[#30363D]');
          t.classList.remove('text-[#8B949E]');
        } else {
          t.classList.remove('bg-[#161B22]', 'text-[#F0F6FC]', 'border-t', 'border-l', 'border-r', 'border-[#30363D]');
          t.classList.add('text-[#8B949E]');
        }
      });

      // Update content visibility
      contents.forEach(content => {
        if ((content as HTMLElement).dataset.content === targetTab) {
          content.classList.remove('hidden');
        } else {
          content.classList.add('hidden');
        }
      });
    });
  });

  // Copy to clipboard functionality
  const copyBtn = document.querySelector('.copy-btn');
  copyBtn?.addEventListener('click', async () => {
    const activeContent = document.querySelector('.code-content:not(.hidden) code');
    if (activeContent && copyBtn) {
      await navigator.clipboard.writeText(activeContent.textContent || '');
      copyBtn.innerHTML = '<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>Copied!';
      setTimeout(() => {
        copyBtn.innerHTML = '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>Copy';
      }, 2000);
    }
  });
</script>
